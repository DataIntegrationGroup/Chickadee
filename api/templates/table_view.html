{% extends "base.html" %}
{% block head %}
{{ super() }}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/default.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/js-beautify/1.14.9/beautify.min.js"></script>

<!-- and it's easy to individually load additional languages -->
<!--<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/go.min.js"></script>-->
<script>hljs.highlightAll();</script>

{% endblock %}

{% block content %}

<div class="row">
    <div class="col-4">
        <h2>Projects</h2>
        <table id="projectstable" class="display compact">
            <thead>
            <tr>
                <th>Project Name</th>
            </tr>
            </thead>
        </table>
    </div>
    <div class="col-8">
        <h2>Samples</h2>
        <table id="samplestable" class="display compact">
            <thead>
            <tr>
                <th>Name</th>
                <th>Project</th>
                <th>Material</th>
                <th>Latitude</th>
                <th>Longitude</th>
                <th>Publication</th>
                <th>DOI</th>
            </tr>
            </thead>
        </table>
    </div>
</div>
<div class="row">
    <div>
        <h2>Sample Details</h2>
        <table id="sampledetailtable" class="display compact">
            <thead>
            <tr>
                <th>Slug</th>
                <th>Value</th>
                <th>Error</th>
                <th>Value Str</th>
                <th>Value Bool</th>
            </tr>
            </thead>
        </table>
    </div>
</div>


<script>
    let sampledetailtable = new DataTable('#sampledetailtable',
        {
            columns: [
                { data: 'slug'},
                {data: 'value'},
                {data: 'error'},
                {data: 'value_str'},
                {data: 'value_bool'},
                // {data: 'material_slug'},
                // {data: 'latitude'},
                // {data: 'longitude'},
            ],
            ajax: {
                 url: 'chickadee/api/v1/sample/detail/empty',
                dataSrc: function (json) {
                    return json.properties;
                }
            }
        }
    )

    let samplestable = new DataTable('#samplestable',
        {
            columns: [
                {data: 'name'},
                {data: 'project_slug'},
                {data: 'material_slug'},
                {data: 'latitude'},
                {data: 'longitude'},
                {data: 'publication'},
                {data: 'doi'},
                {data: 'slug', visible: false}
            ],
            ajax: {
                url: '/api/v1/sample',
                dataSrc: ''
            }}
    )
    samplestable.on('click', 'tr', function () {
        let data = samplestable.row(this).data();
        console.log(data);
        // window.location.href = '/sample/detail/' + data.slug;
        console.log('/api/v1/sample/detail/' + data.slug)
        // sampledetailtable.ajax.dataSrc = function(json) {
        //     return json.properties;
        // }
        sampledetailtable.ajax.url('chickadee/api/v1/sample/detail/' + data.slug).load()
        // sampledetailtable.ajax.reload(function(json) {
        //     console.log('das', json);
        //         $('#sampledetailtable').val(json.properties)
        //     })

    });


    // $('#samplestable').DataTable({
    //     // ordering: false,
    //     // searching: false,
    //     // paging: false,
    //     // info: false,
    //     columns: [
    //         { data: 'name'},
    //         {data: 'project_slug'},
    //         {data: 'material_slug'},
    //         {data: 'latitude'},
    //         {data: 'longitude'},
    //     ],
    //     ajax: {
    //         url: '/api/v1/sample',
    //         dataSrc: ''
    //     }});

    $('#projectstable').DataTable({
        ordering: false,
        // searching: false,
        // paging: false,
        // info: false,
        columns: [
            { data: 'name'},
        ],
        ajax: {
            url: 'chickadee/api/v1/project',
            dataSrc: ''
        }});

</script>
<!--<div>-->
<!--    <table id="projectstable" class="display compact"></table>-->
<!--</div>-->

{% endblock %}

{% block footer %}
{% endblock %}